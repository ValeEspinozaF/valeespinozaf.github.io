<div class="banner d-flex justify-content-between align-items-center mb-5" style="background-color: #f0f0f0; height: 60px">
    <div class="en d-flex col-12 col-xl-11 col-lg-11 col-md-11">
        <a href="/tab_research" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">RESEARCH</p>
        </a>
        <a href="/tab_outreach" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">OUTREACH</p>
        </a>
        <a href="/tab_curriculum" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">CV</p>
        </a>
    </div>
    <div class="es hidden d-flex col-12 col-xl-11 col-lg-11 col-md-11">
        <a href="/tab_research" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">INVESTIGACI&OacuteN</p>
        </a>
        <a href="/tab_outreach" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">DISEMINACI&OacuteN</p>
        </a>
        <a href="/tab_curriculum" class="topic-link d-flex justify-content-center align-items-center text-gray" style="flex: 1; display: flex; justify-content: center; align-items: center; text-align: center;">
            <p style="line-height: 1.5; margin: 0;">CV</p>
        </a>
    </div>
    <div class="hide-on-small d-flex justify-content-end col-xl-1 col-lg-1 col-md-1">
        <a id="language-toggle" class="language-link me-2" href="#" onclick="toggleLanguage(event)">
            {% octicon globe height:16 class:"mr-1 v-align-middle" fill:"#586069" aria-label:globe %}
            <span class="language-text">EN</span>
        </a>
    </div>
</div>


<script>
    // Get the current language from localStorage, default to 'en' if not set
    let currentLanguage = localStorage.getItem('language') || 'en';
    console.log(`Prior currentLanguage: ${currentLanguage}`);

    // Function to toggle language
    function toggleLanguage(event) {
        event.preventDefault();
        
        // Toggle language value
        currentLanguage = currentLanguage === 'en' ? 'es' : 'en';
        console.log(`Toggling to currentLanguage: ${currentLanguage}`);

        // Save new language preference to localStorage
        localStorage.setItem('language', currentLanguage);

        // Update the language display across the page
        applyLanguage();
    }

    // Function to apply the current language setting
    function applyLanguage() {

        const currentLanguage = localStorage.getItem('language') || 'en';
        console.log(`Still currentLanguage: ${currentLanguage}`);

        const languageTexts = document.querySelectorAll('.language-text'); 
        const englishContent = document.querySelectorAll('.en');
        const spanishContent = document.querySelectorAll('.es');

        // Update the language indicator text
        if (currentLanguage === 'es') {
            console.log(`Indeed currentLanguage is ES`);
            languageTexts.forEach(languageText => languageText.textContent = 'ES'); 

            // Hide all English content and show all Spanish content
            englishContent.forEach(element => element.classList.add('hidden'));
            spanishContent.forEach(element => element.classList.remove('hidden'));
        } else {
            console.log(`Indeed currentLanguage is EN`);
            languageTexts.forEach(languageText => languageText.textContent = 'EN'); 

            // Show all English content and hide all Spanish content
            englishContent.forEach(element => element.classList.remove('hidden'));
            spanishContent.forEach(element => element.classList.add('hidden'));
        }

        console.log(`Language switched to: ${currentLanguage}`);
    }

    // Apply the language setting when the page loads
    document.addEventListener('DOMContentLoaded', applyLanguage);
</script>